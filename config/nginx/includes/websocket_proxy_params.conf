# WebSocket-Specific Proxy Parameters
# /etc/nginx/includes/websocket_proxy_params.conf
# Use this for applications with heavy WebSocket usage (Home Assistant, etc.)

# Include standard proxy params first
include /etc/nginx/includes/proxy_params.conf;

#=================================
# WEBSOCKET OPTIMIZATIONS
#=================================

# Longer timeouts for persistent WebSocket connections
proxy_read_timeout 3600s;          # 1 hour for persistent connections
proxy_send_timeout 3600s;          # 1 hour for persistent connections

# Disable buffering for WebSocket traffic
proxy_buffering off;
proxy_request_buffering off;

# WebSocket-specific headers
proxy_set_header Sec-WebSocket-Extensions $http_sec_websocket_extensions;
proxy_set_header Sec-WebSocket-Key $http_sec_websocket_key;
proxy_set_header Sec-WebSocket-Version $http_sec_websocket_version;

# Keep connection alive
proxy_set_header Connection "upgrade";
proxy_cache_bypass $http_upgrade;